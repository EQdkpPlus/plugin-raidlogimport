<script language="JavaScript" type="text/javascript">
//Element to resize
var scale_object = null;
var corner = null;

var raid_start = parseInt("{RAIDSTART}");

//Mouse Position
var posx = 0;
var startx = 0;

//Object data
var oldx = 0;
var max_right = 0;
var min_left = 0;

//max positions
var posi_null = 0;
var posi_max = 0;

//input fields
var joiner = null;
var leaver = null;

document.onmousemove = scale;
document.onmouseup = stop_scale;

function scale_start(member, time, type, margin_left, right_edge) {
	member_id = parseInt(member);
	time_id = parseInt(time);
	var element_id = "times_" + member + "_" + time;
	scale_object = document.getElementById(element_id);
	joiner = document.getElementById(element_id + "j");
	leaver = document.getElementById(element_id + "l");
	oldx = posx - scale_object.offsetLeft;
	startx = posx;
	corner = type;
    if(!posi_null) {
        posi_null = scale_object.offsetLeft - margin_left;
    }
    if(!posi_max) {
        posi_max = posi_null + right_edge;
    }
    var after = document.getElementById("times_" + member + "_" + (time_id+1));
    max_right = posi_max;
    var previous = document.getElementById("times_" + member + "_" + (time_id-1));
    min_left = 0;
    if(after != null) {
    	max_right = posi_null + parseInt(after.style.marginLeft) - 1;
    }
    if(previous != null) {
    	min_left = parseInt(previous.style.marginLeft) + parseInt(previous.style.width) + 1;
    }
}

function stop_scale() {
	scale_object = null;
	joiner = null;
	leaver = null;
	startx = 0;
	oldx = 0;
	max_right = 0;
	left_edge = 0;
	right_edge = 0;
	corner = null;
}

function scale(ereignis) {
	posx = document.all ? window.event.clientX : ereignis.pageX;
	if(scale_object != null) {
		if(corner == "left") {
        	set_width((parseInt(scale_object.style.width) + (startx - posx)), true);
			set_left((posx - oldx - posi_null));
		}
		if(corner == "right") {
			set_width(parseInt(scale_object.style.width) + (posx - startx));
		}
		if(corner == "middle") {
			set_left((posx - oldx - posi_null), true);
		}
        startx = posx;
	}
}

function set_width(w, nostopper) {
	var stopper = false;		
	if(w > 0) {
		if(w+posi_null+parseInt(scale_object.style.marginLeft) > max_right) {
			w = max_right - parseInt(scale_object.style.marginLeft) - posi_null;
			stopper = true;
		}
        scale_object.style.width = w + "px";
		leaver.value = raid_start + (parseInt(scale_object.marginLeft) + w)*20;
	} else {
        scale_object.style.width = 1 + "px";
		leaver.value = raid_start + (parseInt(scale_object.marginLeft) + w)*20;
		stopper = true;
	}
	if(stopper && !nostopper) {
		stop_scale();
	}
}

function set_left(l, nostopper) {
	var stopper = false;
	if(l >= min_left) {
		if(l >= max_right - posi_null - parseInt(scale_object.style.width)) {
			l = max_right - posi_null - parseInt(scale_object.style.width);
			stopper = true;
		}
		scale_object.style.marginLeft = l + "px";
		joiner.value = raid_start + l*20;
	} else {
		scale_object.style.marginLeft = min_left + "px";
		joiner.value = raid_start + l*20;
		stopper = true;
	}
	if(stopper && !nostopper) {
		stop_scale();
	}
}

function showtime(anchor) {
	document.getElementById(anchor).className = 'time_scale';
}

function hidetime(time_id) {
	document.getElementById(time_id).className = 'time_scale_hide';
}
</script>
<style type="text/css">
.raid {
	position: absolute;
	height: 20px;
	background-color: red;
	margin-top: -10px;
	z-index: 9;
}
.boss {
	position: absolute;
	height: 26px;
	background-color: black;
	width: 4px;
	margin-top: -13px;
	z-index: 10;
}
.time {
	position: absolute;
	background-color: green;
	margin-top: -4px;
	height: 8px;
	display: block;
	z-index: 11;
}
.time_standby {
	position: absolute;
	background-color: yellow;
	margin-top: -4px;
	height: 8px;
	display: block;
	z-index: 12;
}
.time_left {
	cursor: e-resize;
	position: absolute;
	margin-left: 0px;
	width: 3%;
	height: 8px;
	z-index: 13;
}
.time_middle {
	cursor: move;
	position: absolute;
	left: 3%;
	width: 94%;
	height: 8px;
	z-index: 13;
}
.time_right {
	cursor: e-resize;
	position: absolute;
	float: right;
	right: 0px;
	width: 3%;
	height: 8px;
	z-index: 13;
}
.time_scale {
	position: absolute;
	background-image: url(./../../../plugins/raidlogimport/images/time_scale.png);
	background-repeat: repeat-x;
	width: {PXTIME}px;
	height: 18px;
	margin-top: 10px;
	z-index: 13;
}

.time_scale_hide {
	display: none;
}
.rli_tooltip {
	background-image: url(./../images/tooltip.png);
	background-position: top left;
}
.rli_tooltip_right {
	background-image: url(./../images/tooltip.png);
	width: 3px;
	background-position: top right;
}
.rli_tooltip_bottom {
	background-image: url(./../images/tooltip.png);
	height: 3px;
	background-position: bottom left;
}
.rli_tooltip_bottom_right {
	background-image: url(./../images/tooltip.png);
	width: 3px;
	height: 3px;
	background-position: bottom right;
}
</style>
<form method="post" action="{F_PARSE}" name="post" id="member_form">
	<table border="0" cellspacing="1" cellpadding="1" id="member" width="200%">
	  <tr>
        <th colspan="3">{L_MEMBERS}</th>
	  </tr>
	  <tr>
        <th width="45px" style="min-width:45px;">&nbsp;</th>
	  	<th style="max-width:300px;">{L_MEMBER}</th>
	  	<th width="{PXTIME}px">{L_RAIDS}</th>
	  </tr>
	  <!-- BEGIN player -->
      <tr class="{player.ZAHL}">
         <td align="right" style="height: 40px;">{player.NR}&nbsp;<img src="./../../../images/global/delete.png" alt="{L_DELETE}"><input type="checkbox" name="members[{player.KEY}][delete]" value="true" title="{L_DELETE}" /></td>
	     <td><input type="text" name="members[{player.KEY}][name]" value="{player.MITGLIED}" /></td>
	     {player.RAID_LIST}
	  </tr>
      <!-- END player -->
	  <tr class="row2">
	  	<td colspan="2"><select name="members_add">
	  		  <option value="0">0..{L_MEMS_ADD}</option>
	  		  <option value="1">1..{L_MEM_ADD}</option>
	  		  <option value="2">2..{L_MEMS_ADD}</option>
	  		  <option value="3">3..{L_MEMS_ADD}</option>
	  		  <option value="4">4..{L_MEMS_ADD}</option>
	  		  <option value="5">5..{L_MEMS_ADD}</option>
	  		</select>
	  		<input type="submit" name="checkmem" value="{L_UPD}" class="mainoption" />
	  	</td>
	  	<td class="row2" colspan="99">&nbsp;</td>
	  </tr>
    </table>
    <table width="100%" border="0" cellspacing="1" cellpadding="1">
      <tr>
        <th align="center" colspan="8">
      	   <input type="hidden" name="rest" value="{DATA}" />
      	   <input type="submit" name="checkraid" value="{L_BACK2RAID}" class="mainoption" />
		   <input type="submit" name="checkitem" value="{L_GO_ON} ({L_CHECKITEMS})" class="mainoption" /></th>
      </tr>
	</table>
</form>